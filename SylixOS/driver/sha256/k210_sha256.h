/*********************************************************************************************************
**
**                                    中国软件开源组织
**
**                                   嵌入式实时操作系统
**
**                                       SylixOS(TM)
**
**                               Copyright  All Rights Reserved
**
**--------------文件信息--------------------------------------------------------------------------------
**
** 文   件   名: k210_sha256.h
**
** 创   建   人: Yu.KangZhi (余康志)
**
** 文件创建日期: 2018 年 10 月 23 日
**
** 描        述: 安全散列算法加速器(SHA256)驱动头文件
*********************************************************************************************************/
#ifndef __K210_SHA256_H
#define __K210_SHA256_H
/*********************************************************************************************************
  包含IOCTL命令定义相关头文件
*********************************************************************************************************/
#include <sys/ioccom.h>                                                 /*       使用 _IO 宏            */
/*********************************************************************************************************
  Kendryte K210 安全散列计算器 SHA256 ioctl 命令
*********************************************************************************************************/
#define IOCTL_SHA256_CONTEXT_INIT       _IO('s',0x01)
#define IOCTL_SHA256_SUBMIT_INPUT       _IO('s',0x02)
#define IOCTL_SHA256_OBTAIN_OUTPUT      _IO('s',0x03)
#define IOCTL_SHA256_HARD_CACULATE      _IO('s',0x04)
/*********************************************************************************************************
  SHA256 WORK MESSAGE (SHA256 散列值计算事务结构体)
*********************************************************************************************************/
typedef struct {
    size_t        trans_len;
    UINT8        *input;
    size_t        input_len;
    UINT8        *output;                                               /* 必须保证该buffer为32Byte以上 */
    size_t        output_len;
} sha256_msg_t;
/*********************************************************************************************************
** 函数名称: k210Sha256Drv
** 功能描述: 安装 SHA256 驱动
** 输　入  : NONE
** 输　出  : ERROR_CODE
** 全局变量:
** 调用模块:
*********************************************************************************************************/
INT  k210Sha256Drv(VOID);
/*********************************************************************************************************
** 函数名称: k210Sha256DevAdd
** 功能描述: 创建 SHA256 设备
** 输　入  : uiChannel         通道号
** 输　出  : ERROR_CODE
** 全局变量:
** 调用模块:
*********************************************************************************************************/
INT  k210Sha256DevAdd(VOID);

#endif                                                                  /*   __K210_SHA256_H            */
/*********************************************************************************************************
  END
*********************************************************************************************************/
